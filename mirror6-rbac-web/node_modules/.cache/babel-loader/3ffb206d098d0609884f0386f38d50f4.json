{"ast":null,"code":"import _objectSpread from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Form,Input,Modal,Radio,TreeSelect}from'antd';import{reqRoleTree}from'../../../api/api.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FormItem=Form.Item;var formItemLayout={labelCol:{span:6},wrapperCol:{span:14}};var UserModal=/*#__PURE__*/function(_React$Component){_inherits(UserModal,_React$Component);var _super=_createSuper(UserModal);function UserModal(){var _this;_classCallCheck(this,UserModal);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.formRef=/*#__PURE__*/React.createRef();_this.state={treeData:[]};_this.onOk=function(){var user=_this.formRef.current.getFieldsValue();_this.props.handleOk(user);};_this.getTreeData=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return reqRoleTree();case 2:result=_context.sent;if(result.code===200){data=result.data;console.log(JSON.stringify(data));_this.treeFormat(data);}case 4:case\"end\":return _context.stop();}}},_callee);}));_this.treeFormat=function(data){data.map(function(item,index){item['title']=item.name;item['value']=item.id;item['key']=item.id;item['children']=item.childList;delete item['id'];delete item['childList'];_this.treeFormat(item.children);});_this.setState({treeData:data});};return _this;}_createClass(UserModal,[{key:\"componentDidMount\",value:function componentDidMount(){this.getTreeData();}},{key:\"render\",value:function render(){var _this$props=this.props,visible=_this$props.visible,modalStatus=_this$props.modalStatus,currentItem=_this$props.currentItem;var treeData=this.state.treeData;console.log(\"6:\"+modalStatus);console.log(\"7:\"+JSON.stringify(currentItem));if(modalStatus==='add'){this.currentItem=null;// this.formRef.current.setFieldsValue({\n//     gender: currentItem.gender,\n// })\n}else{this.currentItem=currentItem;// this.currentItem.roleIds=[1]\n}return/*#__PURE__*/_jsx(Modal,{visible:visible,title:\"\".concat(modalStatus==='add'?'添加':'编辑',\"\\u7528\\u6237\"),okText:\"\\u786E\\u5B9A\",cancelText:\"\\u53D6\\u6D88\",onOk:this.onOk.bind(this),onCancel:this.props.onCancel,children:/*#__PURE__*/_jsxs(Form,_objectSpread(_objectSpread({ref:this.formRef,initialValues:this.currentItem},formItemLayout),{},{children:[/*#__PURE__*/_jsx(FormItem,{name:\"id\",label:\"\\u4E3B\\u952E\",hidden:true,children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(FormItem,{name:\"account\",label:\"\\u8D26\\u53F7\",rules:[{required:true,message:'请输入账号'},{pattern:new RegExp(/^[0-9]\\d*$/,\"g\"),message:'账号由数字组成'}],children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u8D26\\u53F7\"})}),/*#__PURE__*/_jsx(FormItem,{name:\"name\",label:\"\\u59D3\\u540D\",rules:[{required:true,message:'请输入姓名'}],children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u59D3\\u540D\"})}),/*#__PURE__*/_jsx(FormItem,{name:\"gender\",label:\"\\u6027\\u522B\",children:/*#__PURE__*/_jsxs(Radio.Group,{children:[/*#__PURE__*/_jsx(Radio,{value:1,children:\"\\u7537\"}),/*#__PURE__*/_jsx(Radio,{value:0,children:\"\\u5973\"})]})}),/*#__PURE__*/_jsx(FormItem,{name:\"tel\",label:\"\\u624B\\u673A\\u53F7\\u7801\",children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u624B\\u673A\\u53F7\\u7801\"})}),/*#__PURE__*/_jsx(FormItem,{name:\"email\",label:\"\\u7535\\u5B50\\u90AE\\u7BB1\",rules:[{type:'email',message:'请输入正确的邮箱'}],children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u7535\\u5B50\\u90AE\\u7BB1\"})}),/*#__PURE__*/_jsx(FormItem,{name:\"roleIds\",label:\"\\u89D2\\u8272\",rules:[{required:true}],children:/*#__PURE__*/_jsx(TreeSelect,{allowClear:\"true\",treeCheckable:\"true\",treeData:treeData,placeholder:\"\\u8BF7\\u9009\\u62E9\\u89D2\\u8272\",value:this.currentItem.roleIds})})]}))});}}]);return UserModal;}(React.Component);export default UserModal;","map":{"version":3,"sources":["/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/src/pages/system/user/userModal.jsx"],"names":["React","Form","Input","Modal","Radio","TreeSelect","reqRoleTree","FormItem","Item","formItemLayout","labelCol","span","wrapperCol","UserModal","formRef","createRef","state","treeData","onOk","user","current","getFieldsValue","props","handleOk","getTreeData","result","code","data","console","log","JSON","stringify","treeFormat","map","item","index","name","id","childList","children","setState","visible","modalStatus","currentItem","bind","onCancel","required","message","pattern","RegExp","type","roleIds","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {Form, Input, Modal, Radio, TreeSelect} from 'antd'\nimport {reqRoleTree} from '../../../api/api.js'\n\n\nconst FormItem = Form.Item;\nconst formItemLayout = {\n    labelCol: {span: 6},\n    wrapperCol: {span: 14}\n};\n\nclass UserModal extends React.Component {\n\n    formRef = React.createRef();\n\n    state = {\n        treeData: []\n    }\n\n    componentDidMount() {\n        this.getTreeData();\n    }\n\n    onOk = () => {\n        let user = this.formRef.current.getFieldsValue();\n        this.props.handleOk(user);\n    }\n\n    getTreeData = async () => {\n        const result = await reqRoleTree();\n        if (result.code === 200) {\n            const data = result.data;\n            console.log(JSON.stringify(data));\n            this.treeFormat(data);\n        }\n    }\n\n    treeFormat = (data) => {\n        data.map((item, index) => {\n            item['title'] = item.name;\n            item['value'] = item.id;\n            item['key'] = item.id;\n            item['children'] = item.childList\n            delete item['id'];\n            delete item['childList'];\n            this.treeFormat(item.children);\n        });\n        this.setState({\n            treeData: data\n        });\n    }\n\n\n    render() {\n\n        const {visible, modalStatus, currentItem} = this.props\n        const {treeData} = this.state\n\n        console.log(\"6:\" + modalStatus)\n        console.log(\"7:\" + JSON.stringify(currentItem))\n        if (modalStatus === 'add') {\n            this.currentItem = null\n\n            // this.formRef.current.setFieldsValue({\n            //     gender: currentItem.gender,\n            // })\n\n        }else{\n            this.currentItem=currentItem\n            // this.currentItem.roleIds=[1]\n        }\n        return (\n\n            <Modal\n                visible={visible}\n                title={`${modalStatus === 'add' ? '添加' : '编辑'}用户`}\n                okText='确定'\n                cancelText='取消'\n                onOk={this.onOk.bind(this)}\n                onCancel={this.props.onCancel}\n            >\n                <Form ref={this.formRef} initialValues={this.currentItem} {...formItemLayout} >\n\n                    <FormItem name=\"id\" label=\"主键\" hidden>\n                        <Input/>\n                    </FormItem>\n\n                    <FormItem name=\"account\" label=\"账号\" rules={[\n                        {\n                            required: true,\n                            message: '请输入账号',\n                        },\n                        {\n                            pattern: new RegExp(/^[0-9]\\d*$/, \"g\"),\n                            message: '账号由数字组成',\n                        },\n                    ]}>\n                        <Input placeholder=\"请输入账号\"/>\n                    </FormItem>\n\n                    <FormItem name=\"name\" label=\"姓名\" rules={[\n                        {\n                            required: true,\n                            message: '请输入姓名',\n                        },\n                    ]}>\n                        <Input placeholder=\"请输入姓名\"/>\n                    </FormItem>\n\n                    <FormItem name=\"gender\" label=\"性别\">\n                        <Radio.Group >\n                            <Radio value={1}>男</Radio>\n                            <Radio value={0}>女</Radio>\n                        </Radio.Group>\n                    </FormItem>\n\n                    <FormItem name=\"tel\" label=\"手机号码\">\n                        <Input placeholder=\"请输入手机号码\"/>\n                    </FormItem>\n\n                    <FormItem name=\"email\" label=\"电子邮箱\" rules={[\n                        {\n                            type: 'email',\n                            message: '请输入正确的邮箱',\n                        },\n                    ]}>\n                        <Input placeholder=\"请输入电子邮箱\"/>\n                    </FormItem>\n\n                    <FormItem name=\"roleIds\" label=\"角色\" rules={[\n                        {\n                            required: true,\n                        },\n                    ]}>\n                        <TreeSelect\n                            allowClear=\"true\"\n                            treeCheckable=\"true\"\n                            treeData={treeData}\n                            placeholder=\"请选择角色\"\n                            value={this.currentItem.roleIds}\n                        />\n\n                    </FormItem>\n\n                </Form>\n            </Modal>\n\n        )\n    }\n}\n\nexport default UserModal;"]},"metadata":{},"sourceType":"module"}