{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import jwt_decode from'jwt-decode';// import { Redirect } from 'react-router-dom'\nimport{Form,Input,Button,Checkbox,message}from'antd';import{UserOutlined,LockOutlined}from'@ant-design/icons';// import Login from './login'\nimport'./login.css';import logo from'../../assets/images/log.jpg';import{reqLogin}from'../../api/api';import memoryUtil from'../../utils/memoryUtil';import storageUtil from'../../utils/storageUtil';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var login=/*#__PURE__*/function(_Component){_inherits(login,_Component);var _super=_createSuper(login);function login(){var _this;_classCallCheck(this,login);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.formRef=/*#__PURE__*/React.createRef();_this.onFinish=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var result,userToken,user,user1;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(values);_context.next=3;return reqLogin(values);case 3:result=_context.sent;if(result.code===200){message.success(\"登录成功\");userToken=result.data;user=jwt_decode(userToken);// memoryUtil.user = user;\nstorageUtil.setUser(user);storageUtil.setToken(userToken);user1=storageUtil.getUser();console.log(\"登录后user:\"+JSON.stringify(user1));_this.props.history.replace('/');}else{message.error(\"登录失败\");}// message.success(\"登录成功\");\n// this.props.history.replace('/');\ncase 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.onFinishFailed=function(errorInfo){console.log('Failed:',errorInfo);};return _this;}_createClass(login,[{key:\"render\",value:function render(){// const user = memoryUtil.user;\n// if (user && user.id) {\n//     return <Redirect to='./loi' />\n// }\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"login-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Mirror6-rbac\"})}),/*#__PURE__*/_jsxs(\"section\",{className:\"login-content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u7528\\u6237\\u767B\\u5F55\"}),/*#__PURE__*/_jsxs(Form,{ref:this.formRef,name:\"normal_login\",className:\"login-form\",initialValues:{remember:true},onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"username\",rules:[{required:true,message:'请输入账号!'}],children:/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(UserOutlined,{className:\"site-form-item-icon\"}),placeholder:\"\\u8D26\\u53F7\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"password\",rules:[{required:true,message:'请输入密码!'}],children:/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(LockOutlined,{className:\"site-form-item-icon\"}),type:\"password\",placeholder:\"\\u5BC6\\u7801\"})}),/*#__PURE__*/_jsxs(Form.Item,{children:[/*#__PURE__*/_jsx(Form.Item,{name:\"remember\",valuePropName:\"checked\",noStyle:true,children:/*#__PURE__*/_jsx(Checkbox,{children:\"\\u8BB0\\u4F4F\\u6211\"})}),/*#__PURE__*/_jsx(\"a\",{className:\"login-form-forgot\",href:\"\",children:\"\\u5FD8\\u8BB0\\u5BC6\\u7801\"})]}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",className:\"login-form-button\",children:\"\\u767B\\u5F55\"})})]})]})]});}}]);return login;}(Component);export default login;","map":{"version":3,"sources":["/Users/mirror6/IdeaProjects/mirror6-rbac0/mirror6-rbac-web/src/pages/login/login.jsx"],"names":["React","Component","jwt_decode","Form","Input","Button","Checkbox","message","UserOutlined","LockOutlined","logo","reqLogin","memoryUtil","storageUtil","login","formRef","createRef","onFinish","values","console","log","result","code","success","userToken","data","user","setUser","setToken","user1","getUser","JSON","stringify","props","history","replace","error","onFinishFailed","errorInfo","remember","required"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport jwt_decode from 'jwt-decode'\n\n// import { Redirect } from 'react-router-dom'\nimport { Form, Input, Button, Checkbox, message } from 'antd';\nimport { UserOutlined, LockOutlined } from '@ant-design/icons';\n// import Login from './login'\nimport './login.css';\nimport logo from '../../assets/images/log.jpg';\nimport { reqLogin } from '../../api/api'\nimport memoryUtil from '../../utils/memoryUtil'\nimport storageUtil from '../../utils/storageUtil'\n\n\nclass login extends Component {\n\n    formRef = React.createRef();\n\n    onFinish = async values => {\n        console.log(values);\n\n        const result = await reqLogin(values);\n        if (result.code === 200) {\n           \n            message.success(\"登录成功\");\n            const userToken = result.data;\n            let user=jwt_decode(userToken);\n            // memoryUtil.user = user;\n            storageUtil.setUser(user);\n            storageUtil.setToken(userToken);\n            let user1=storageUtil.getUser();\n            console.log(\"登录后user:\"+JSON.stringify(user1))\n            this.props.history.replace('/');\n        } else {\n            message.error(\"登录失败\");\n        }\n        // message.success(\"登录成功\");\n        // this.props.history.replace('/');\n\n    }\n\n    onFinishFailed = errorInfo => {\n        console.log('Failed:', errorInfo);\n    };\n    render() {\n        // const user = memoryUtil.user;\n        // if (user && user.id) {\n        //     return <Redirect to='./loi' />\n        // }\n\n        return (\n            <div className=\"login\">\n                <header className=\"login-header\">\n                    <h1>Mirror6-rbac</h1>\n                </header>\n                <section className=\"login-content\">\n                    <h2>用户登录</h2>\n                    <Form\n                        ref={this.formRef}\n                        name=\"normal_login\"\n                        className=\"login-form\"\n                        initialValues={{\n                            remember: true,\n                        }}\n                        onFinish={this.onFinish}\n                        onFinishFailed={this.onFinishFailed}\n                    >\n                        <Form.Item\n                            name=\"username\"\n                            rules={[\n                                {\n                                    required: true,\n                                    message: '请输入账号!'\n                                },\n                            ]}\n                        >\n                            <Input prefix={<UserOutlined className=\"site-form-item-icon\" />} placeholder=\"账号\" />\n                        </Form.Item>\n                        <Form.Item\n                            name=\"password\"\n                            rules={[\n                                {\n                                    required: true,\n                                    message: '请输入密码!'\n                                },\n                            ]}\n                        >\n                            <Input\n                                prefix={<LockOutlined className=\"site-form-item-icon\" />}\n                                type=\"password\"\n                                placeholder=\"密码\"\n                            />\n                        </Form.Item>\n                        <Form.Item>\n                            <Form.Item name=\"remember\" valuePropName=\"checked\" noStyle>\n                                <Checkbox>记住我</Checkbox>\n                            </Form.Item>\n\n                            <a className=\"login-form-forgot\" href=\"\">忘记密码</a>\n                        </Form.Item>\n\n                        <Form.Item>\n                            <Button type=\"primary\" htmlType=\"submit\" className=\"login-form-button\">登录</Button>\n                        </Form.Item>\n                    </Form>\n                </section>\n            </div>\n        );\n    }\n}\n\nexport default login;"]},"metadata":{},"sourceType":"module"}